<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BD IPTV Player</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        body { margin: 0; display: flex; height: 100vh; background: #0f0f0f; color: white; font-family: sans-serif; overflow: hidden; }
        #sidebar { width: 300px; background: #1a1a1a; display: flex; flex-direction: column; border-right: 1px solid #333; }
        #sidebar h2 { padding: 15px; margin: 0; background: #252525; font-size: 18px; text-align: center; color: #00ff88; }
        
        /* ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶¨‡¶ï‡ßç‡¶∏‡ßá‡¶∞ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
        #search-container { padding: 10px; background: #252525; }
        #search-input { width: 90%; padding: 8px; border-radius: 5px; border: none; background: #333; color: white; outline: none; }

        #channel-list { flex-grow: 1; overflow-y: auto; }
        .channel-item { padding: 12px 15px; cursor: pointer; border-bottom: 1px solid #262626; font-size: 14px; }
        .channel-item:hover { background: #333; color: #00ff88; }
        
        #player-container { flex-grow: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; background: black; }
        video { width: 100%; height: auto; max-height: 80vh; background: black; }
        
        .controls { padding: 20px; text-align: center; }
        .vol-btn { padding: 10px 20px; background: #333; color: white; border: none; cursor: pointer; border-radius: 5px; margin: 5px; }
        .vol-btn:hover { background: #444; }
    </style>
</head>
<body>

<div id="sidebar">
    <h2>BD IPTV Player</h2>
    <div id="search-container">
        <input type="text" id="search-input" placeholder="‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤..." onkeyup="filterChannels()">
    </div>
    <div id="channel-list">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
</div>

<div id="player-container">
    <video id="video" controls autoplay></video>
    <div class="controls">
        <button class="vol-btn" onclick="changeVolume(-0.1)">üîâ -</button>
        <button class="vol-btn" onclick="changeVolume(0.1)">üîä +</button>
    </div>
</div>

<script>
    const video = document.getElementById('video');
    const hls = new Hls();
    let allChannels = []; // ‡¶∏‡¶¨ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

    async function loadPlaylist() {
        try {
            const r = await fetch('https://iptv-org.github.io/iptv/index.m3u');
            const data = await r.text();
            const lines = data.split('\n');
            
            let currentName = '';
            let currentGroup = '';

            for (let i = 0; i < lines.length; i++) {
                let line = lines[i].trim();
                if (line.startsWith('#EXTINF:')) {
                    // ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡¶æ
                    currentName = line.split(',')[1] || "Unknown";
                    // ‡¶ó‡ßç‡¶∞‡ßÅ‡¶™ ‡¶¨‡¶æ ‡¶¶‡ßá‡¶∂ ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡¶æ
                    if (line.includes('group-title="')) {
                        currentGroup = line.split('group-title="')[1].split('"')[0];
                    } else {
                        currentGroup = "";
                    }
                } else if (line.startsWith('http')) {
                    allChannels.push({ name: currentName, url: line, group: currentGroup });
                }
            }

            // ‡ßß. ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂‡¶ø ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶Ü‡¶≤‡¶æ‡¶¶‡¶æ ‡¶ï‡¶∞‡¶æ
            const bdChannels = allChannels.filter(c => c.name.toLowerCase().includes('bangladesh') || c.group.toLowerCase().includes('bangladesh'));
            // ‡ß®. ‡¶á‡¶®‡ßç‡¶°‡¶ø‡ßü‡¶æ‡¶® ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶Ü‡¶≤‡¶æ‡¶¶‡¶æ ‡¶ï‡¶∞‡¶æ
            const inChannels = allChannels.filter(c => (c.name.toLowerCase().includes('india') || c.group.toLowerCase().includes('india')) && !bdChannels.includes(c));
            // ‡ß©. ‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤
            const otherChannels = allChannels.filter(c => !bdChannels.includes(c) && !inChannels.includes(c));

            // ‡¶∏‡¶æ‡¶ú‡¶æ‡¶®‡ßã ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶§‡ßà‡¶∞‡¶ø: BD -> India -> Others
            allChannels = [...bdChannels, ...inChannels, ...otherChannels];
            
            displayChannels(allChannels);
        } catch (e) { 
            document.getElementById('channel-list').innerText = "Error loading list"; 
        }
    }

    function displayChannels(channels) {
        const list = document.getElementById('channel-list');
        list.innerHTML = '';
        channels.forEach(ch => {
            const item = document.createElement('div');
            item.className = 'channel-item';
            item.innerText = ch.name;
            item.onclick = () => {
                if (Hls.isSupported()) {
                    hls.loadSource(ch.url);
                    hls.attachMedia(video);
                }
            };
            list.appendChild(item);
        });
    }

    // ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
    function filterChannels() {
        const query = document.getElementById('search-input').value.toLowerCase();
        const filtered = allChannels.filter(ch => ch.name.toLowerCase().includes(query));
        displayChannels(filtered);
    }

    function changeVolume(a) { 
        let v = video.volume + a; 
        if (v >= 0 && v <= 1) video.volume = v; 
    }

    loadPlaylist();
</script>
</body>
</html>
